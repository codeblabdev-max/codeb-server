# CodeB Infrastructure Architecture

CodeB ì‹œìŠ¤í…œì˜ 4-Layer ì¸í”„ë¼ ì•„í‚¤í…ì²˜ ì™„ì „ ê°€ì´ë“œ

**Version:** 1.0
**Last Updated:** 2025-01-09
**Author:** Leo Company Architecture Team

---

## ëª©ì°¨

1. [ì•„í‚¤í…ì²˜ ê°œìš”](#ì•„í‚¤í…ì²˜-ê°œìš”)
2. [Layer 1: App Layer](#layer-1-app-layer)
3. [Layer 2: Server Layer](#layer-2-server-layer)
4. [Layer 3: IaC Layer](#layer-3-iac-layer)
5. [Layer 4: Agent/DevOps Layer](#layer-4-agentdevops-layer)
6. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)
7. [ë°°í¬ í”„ë¡œì„¸ìŠ¤](#ë°°í¬-í”„ë¡œì„¸ìŠ¤)
8. [ë³´ì•ˆ ì•„í‚¤í…ì²˜](#ë³´ì•ˆ-ì•„í‚¤í…ì²˜)
9. [ëª¨ë‹ˆí„°ë§ ë° ê´€ì°°ì„±](#ëª¨ë‹ˆí„°ë§-ë°-ê´€ì°°ì„±)
10. [í™•ì¥ ì „ëµ](#í™•ì¥-ì „ëµ)

---

## ì•„í‚¤í…ì²˜ ê°œìš”

CodeBëŠ” **ì„ ì–¸ì  ì¸í”„ë¼ ê´€ë¦¬**ì™€ **AI ê¸°ë°˜ ìë™í™”**ë¥¼ ê²°í•©í•œ Private PaaS ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### í•µì‹¬ ì„¤ê³„ ì›ì¹™

1. **Stateless Application**: ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ìƒíƒœë¥¼ ê°€ì§€ì§€ ì•ŠìŒ (ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥)
2. **Declarative Infrastructure**: ëª¨ë“  ì¸í”„ë¼ëŠ” YAML ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¡œ ì„ ì–¸
3. **Automated Operations**: ë°°í¬, ìŠ¤ì¼€ì¼ë§, ë°±ì—… ë“± ëª¨ë“  ìš´ì˜ì´ ìë™í™”
4. **AI-Driven Development**: Claude Code ê¸°ë°˜ ê°œë°œ ì›Œí¬í”Œë¡œìš° í†µí•©

### ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CodeB 4-Layer Architecture                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Layer 4: Agent/DevOps Layer                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Claude Code Agents                     GitHub Actions CI/CD          â”‚  â”‚
â”‚  â”‚  - @orchestrator: ì›Œí¬í”Œë¡œìš° ì¡°ìœ¨        - Build & Test                â”‚  â”‚
â”‚  â”‚  - @architect: DB/API ì„¤ê³„              - Image Build                 â”‚  â”‚
â”‚  â”‚  - @backend-dev: API ê°œë°œ               - Deploy to Server            â”‚  â”‚
â”‚  â”‚  - @frontend-dev: UI ê°œë°œ               - Health Check                â”‚  â”‚
â”‚  â”‚  - @e2e-tester: í…ŒìŠ¤íŠ¸                  - Rollback (ì‹¤íŒ¨ ì‹œ)           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚  Layer 3: IaC Layer (Infrastructure as Code)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Project Manifests (YAML)              Terraform (ì„ íƒ)               â”‚  â”‚
â”‚  â”‚  - project: í”„ë¡œì íŠ¸ ì •ì˜                - Vultr ì„œë²„ í”„ë¡œë¹„ì €ë‹        â”‚  â”‚
â”‚  â”‚  - environment: ë„ë©”ì¸/í™˜ê²½              - ë°©í™”ë²½ ê·œì¹™                  â”‚  â”‚
â”‚  â”‚  - servers: ì„œë²„ í• ë‹¹                    - Load Balancer               â”‚  â”‚
â”‚  â”‚  - resources: í¬íŠ¸/CPU/ë©”ëª¨ë¦¬            - Auto-Scaling ê·¸ë£¹            â”‚  â”‚
â”‚  â”‚  - features: ê¸°ëŠ¥ ëª¨ë“ˆ                                                 â”‚  â”‚
â”‚  â”‚  - monitoring: ëª¨ë‹ˆí„°ë§ ì„¤ì •                                           â”‚  â”‚
â”‚  â”‚  - backup: ë°±ì—… ì •ì±…                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚  Layer 2: Server Layer                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Podman (Container Runtime)                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â”‚ PostgreSQL  â”‚  â”‚    Redis     â”‚  â”‚  MinIO   â”‚  â”‚  Caddy   â”‚       â”‚  â”‚
â”‚  â”‚  â”‚ (Database)  â”‚  â”‚   (Cache)    â”‚  â”‚ (Storage)â”‚  â”‚  (Proxy) â”‚       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  + Quadlet: ì„ ì–¸ì  ì»¨í…Œì´ë„ˆ ê´€ë¦¬                                       â”‚  â”‚
â”‚  â”‚  + systemd: ìë™ ì¬ì‹œì‘ ë° ë¡œê¹…                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚  Layer 1: App Layer (Stateless)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Next.js Applications                                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚  â”‚ Project1 â”‚  â”‚ Project2 â”‚  â”‚ Project3 â”‚  â”‚ ProjectN â”‚  ...         â”‚  â”‚
â”‚  â”‚  â”‚ :3000    â”‚  â”‚ :3001    â”‚  â”‚ :3002    â”‚  â”‚ :300N    â”‚              â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  íŠ¹ì§•:                                                                 â”‚  â”‚
â”‚  â”‚  - Core CMS í…œí”Œë¦¿ ê¸°ë°˜                                                â”‚  â”‚
â”‚  â”‚  - Stateless (ì„¸ì…˜ì€ Redis ì €ì¥)                                       â”‚  â”‚
â”‚  â”‚  - ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥                                                      â”‚  â”‚
â”‚  â”‚  - í¬íŠ¸ ìë™ í• ë‹¹ (3000-3999)                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Layer 1: App Layer

ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ - Stateless Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì´ ì‹¤í–‰ë˜ëŠ” ë ˆì´ì–´

### í•µì‹¬ íŠ¹ì§•

- **Stateless Architecture**: ëª¨ë“  ìƒíƒœëŠ” ì™¸ë¶€ ì €ì¥ì†Œ(PostgreSQL, Redis)ì— ì €ì¥
- **Core CMS Template**: í‘œì¤€í™”ëœ í”„ë¡œì íŠ¸ êµ¬ì¡°
- **Auto Port Allocation**: í¬íŠ¸ ìë™ í• ë‹¹ ë° ì¶©ëŒ ë°©ì§€
- **Horizontal Scalability**: ë¬´ìƒíƒœì´ë¯€ë¡œ ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥

### í‘œì¤€ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/             # ì¸ì¦ ê·¸ë£¹
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚   â”œâ”€â”€ (dashboard)/        # ëŒ€ì‹œë³´ë“œ ê·¸ë£¹
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”‚   â”œâ”€â”€ api/                # API Routes
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ health/
â”‚   â”‚   â”‚   â””â”€â”€ metrics/
â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”œâ”€â”€ components/             # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ ui/                 # ê¸°ë³¸ UI (shadcn/ui)
â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ input.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ features/           # ê¸°ëŠ¥ë³„ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚       â”œâ”€â”€ auth/
â”‚   â”‚       â”œâ”€â”€ dashboard/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ lib/                    # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ db.ts               # Prisma í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ redis.ts            # Redis í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ auth.ts             # NextAuth ì„¤ì •
â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â”œâ”€â”€ hooks/                  # Custom Hooks
â”‚   â””â”€â”€ types/                  # TypeScript íƒ€ì…
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma           # DB ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ migrations/             # ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ public/                     # ì •ì  íŒŒì¼
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ e2e/                    # Playwright E2E
â”‚   â””â”€â”€ unit/                   # Jest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ .env.example
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

### ê¸°ìˆ  ìŠ¤íƒ (ê³ ì •)

| ì˜ì—­ | ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|-----|------|------|------|
| Framework | Next.js | 14+ | í’€ìŠ¤íƒ í”„ë ˆì„ì›Œí¬ |
| Language | TypeScript | 5+ | íƒ€ì… ì•ˆì •ì„± |
| Database ORM | Prisma | 5+ | ë°ì´í„°ë² ì´ìŠ¤ ORM |
| Authentication | NextAuth.js | 4+ | ì¸ì¦/ì¸ê°€ |
| Styling | Tailwind CSS | 3+ | CSS í”„ë ˆì„ì›Œí¬ |
| UI Components | shadcn/ui | Latest | UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| State Management | Zustand | 4+ | í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ê´€ë¦¬ |
| Form Handling | React Hook Form | 7+ | í¼ ê²€ì¦ |
| Validation | Zod | 3+ | ìŠ¤í‚¤ë§ˆ ê²€ì¦ |

### í™˜ê²½ ë³€ìˆ˜ íŒ¨í„´

```bash
# Database
DATABASE_URL="postgresql://user:pass@host:5432/dbname"

# Auth
NEXTAUTH_URL="https://app.leocompany.com"
NEXTAUTH_SECRET="generated-secret-key"

# Redis
REDIS_HOST="45.76.178.123"
REDIS_PORT="6379"
REDIS_DB="2"

# MinIO (File Upload)
MINIO_ENDPOINT="minio.leocompany.com"
MINIO_BUCKET="project-uploads"
MINIO_ACCESS_KEY="from-vault"
MINIO_SECRET_KEY="from-vault"

# App Config
NEXT_PUBLIC_APP_NAME="Project Name"
NEXT_PUBLIC_API_URL="https://api.project.leocompany.com"
```

### í¬íŠ¸ í• ë‹¹ ê·œì¹™

- **ë²”ìœ„**: 3000-3999 (1000ê°œ í”„ë¡œì íŠ¸ ìˆ˜ìš© ê°€ëŠ¥)
- **ìë™ í• ë‹¹**: ë§¤ë‹ˆí˜ìŠ¤íŠ¸ì— ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ ìë™ í• ë‹¹
- **ì¶©ëŒ ë°©ì§€**: Registryì—ì„œ ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ í¬íŠ¸ëŠ” ì œì™¸
- **ì˜ˆì•½ í¬íŠ¸**:
  - 3000: ê°œë°œ í™˜ê²½ ê¸°ë³¸ í¬íŠ¸
  - 3001-3999: í”„ë¡œë•ì…˜ í”„ë¡œì íŠ¸

---

## Layer 2: Server Layer

ì„œë²„ ì¸í”„ë¼ ê³„ì¸µ - Podman ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ì„œë¹„ìŠ¤ë“¤ì´ ì‹¤í–‰ë˜ëŠ” ë ˆì´ì–´

### í•µì‹¬ êµ¬ì„± ìš”ì†Œ

#### 1. PostgreSQL (Database)

```yaml
# Quadlet ì„¤ì •: /etc/containers/systemd/postgresql.container
[Unit]
Description=PostgreSQL Database Server
After=network-online.target

[Container]
Image=docker.io/postgres:16-alpine
ContainerName=postgresql
Environment=POSTGRES_PASSWORD=secure-password
Volume=/var/lib/postgresql/data:/var/lib/postgresql/data:Z
PublishPort=5432:5432
Network=codeb-network

[Service]
Restart=always
TimeoutStartSec=300

[Install]
WantedBy=multi-user.target
```

**íŠ¹ì§•**:
- PostgreSQL 16 ì‚¬ìš© (ìµœì‹  ì•ˆì • ë²„ì „)
- ê° í”„ë¡œì íŠ¸ë³„ ë…ë¦½ëœ ë°ì´í„°ë² ì´ìŠ¤
- ìë™ ë°±ì—… (pg_dump ê¸°ë°˜)
- ì˜êµ¬ ë³¼ë¥¨ ë§ˆìš´íŠ¸

**ë°ì´í„°ë² ì´ìŠ¤ ë„¤ì´ë° ê·œì¹™**:
```
í”„ë¡œì íŠ¸ ID = food-delivery-app
DB ì´ë¦„ = food_delivery_db
```

#### 2. Redis (Cache & Session Store)

```yaml
# Quadlet ì„¤ì •: /etc/containers/systemd/redis.container
[Unit]
Description=Redis Cache Server
After=network-online.target

[Container]
Image=docker.io/redis:7-alpine
ContainerName=redis
PublishPort=6379:6379
Network=codeb-network

[Service]
Restart=always

[Install]
WantedBy=multi-user.target
```

**DB ì¸ë±ìŠ¤ í• ë‹¹**:
- **DB 0**: ì‹œìŠ¤í…œ ì „ì—­ ìºì‹œ
- **DB 1**: ê³µìœ  ìºì‹œ
- **DB 2-15**: í”„ë¡œì íŠ¸ë³„ í• ë‹¹ (ìµœëŒ€ 14ê°œ í”„ë¡œì íŠ¸)

**ì‚¬ìš© ì‚¬ë¡€**:
- ì„¸ì…˜ ì €ì¥ (NextAuth ì„¸ì…˜)
- API ì‘ë‹µ ìºì‹±
- Rate Limiting
- ì‹¤ì‹œê°„ ë°ì´í„° (WebSocket ì—°ê²° ì •ë³´)

#### 3. MinIO (Object Storage)

```yaml
# Quadlet ì„¤ì •: /etc/containers/systemd/minio.container
[Unit]
Description=MinIO Object Storage
After=network-online.target

[Container]
Image=quay.io/minio/minio:latest
ContainerName=minio
Environment=MINIO_ROOT_USER=admin
Environment=MINIO_ROOT_PASSWORD=secure-password
Volume=/var/lib/minio/data:/data:Z
PublishPort=9000:9000
PublishPort=9001:9001
Network=codeb-network
Exec=server /data --console-address ":9001"

[Service]
Restart=always

[Install]
WantedBy=multi-user.target
```

**ë²„í‚· êµ¬ì¡°**:
```
minio/
â”œâ”€â”€ food-delivery-uploads/      # í”„ë¡œì íŠ¸ë³„ ë²„í‚·
â”‚   â”œâ”€â”€ restaurant-images/
â”‚   â”œâ”€â”€ food-images/
â”‚   â””â”€â”€ user-avatars/
â”œâ”€â”€ real-estate-files/
â””â”€â”€ backup/                      # ë°±ì—… ì „ìš© ë²„í‚·
    â”œâ”€â”€ database/
    â””â”€â”€ uploads/
```

#### 4. Caddy (Reverse Proxy & SSL)

```caddyfile
# /etc/caddy/Caddyfile

# ìë™ SSL ë°œê¸‰
(ssl_config) {
    tls {
        protocols tls1.3
        ciphers TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
    }
}

# í”„ë¡œì íŠ¸ë³„ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
food-delivery.leocompany.com {
    import ssl_config
    reverse_proxy localhost:3005
    encode gzip

    # í—¤ë” ì„¤ì •
    header {
        Strict-Transport-Security "max-age=31536000;"
        X-Frame-Options "DENY"
        X-Content-Type-Options "nosniff"
    }
}

# MinIO ì½˜ì†”
minio.leocompany.com {
    import ssl_config
    reverse_proxy localhost:9001
}

# ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸ (ë‚´ë¶€ ì „ìš©)
metrics.internal.leocompany.com {
    reverse_proxy localhost:9090  # Prometheus
}
```

### ë„¤íŠ¸ì›Œí¬ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Podman Network: codeb-network            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  App:3005    â”‚â”€â”€â”€â”€â–¶â”‚ PostgreSQL   â”‚     â”‚   Redis    â”‚  â”‚
â”‚  â”‚  (Next.js)   â”‚     â”‚   :5432      â”‚     â”‚   :6379    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                          â–²         â”‚
â”‚         â”‚                                          â”‚         â”‚
â”‚         â–¼                                          â”‚         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚         â”‚
â”‚  â”‚    MinIO     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”‚  :9000/:9001 â”‚                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì„œë²„ ìŠ¤í™ (Vultr)

| ì„œë²„ íƒ€ì… | ìŠ¤í™ | ìš©ë„ | ì›” ë¹„ìš© |
|----------|------|------|--------|
| App Server | 4 vCPU, 16GB RAM, 200GB SSD | Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ | $80 |
| DB Server | 8 vCPU, 32GB RAM, 400GB SSD | PostgreSQL, Redis | $160 |
| Storage Server | 4 vCPU, 8GB RAM, 1TB SSD | MinIO ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€ | $60 |

---

## Layer 3: IaC Layer

Infrastructure as Code ê³„ì¸µ - ì¸í”„ë¼ë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ì •ì˜í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë ˆì´ì–´

### í”„ë¡œì íŠ¸ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ

#### ë§¤ë‹ˆí˜ìŠ¤íŠ¸ êµ¬ì¡°

```yaml
# project-manifest.yamlì˜ 7ê°€ì§€ í•µì‹¬ ì„¹ì…˜

1. project:       í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°
2. environment:   í™˜ê²½ ë° ë„ë©”ì¸ ì„¤ì •
3. servers:       ì„œë²„ ì¸í”„ë¼ í• ë‹¹
4. resources:     ë¦¬ì†ŒìŠ¤ ì œí•œ ë° í• ë‹¹
5. features:      ê¸°ëŠ¥ ëª¨ë“ˆ í™œì„±í™”
6. monitoring:    ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼
7. backup:        ë°±ì—… ì •ì±…
```

#### ë§¤ë‹ˆí˜ìŠ¤íŠ¸ â†’ ì¸í”„ë¼ ë³€í™˜ í”„ë¡œì„¸ìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  project-manifest.yaml                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CodeB Deploy MCP Server (codeb-deploy)                     â”‚
â”‚  - YAML íŒŒì‹± ë° ê²€ì¦                                         â”‚
â”‚  - ìŠ¤í‚¤ë§ˆ ìœ íš¨ì„± ê²€ì‚¬                                        â”‚
â”‚  - í¬íŠ¸ ì¶©ëŒ í™•ì¸                                            â”‚
â”‚  - Redis DB ì¸ë±ìŠ¤ í• ë‹¹                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Infrastructure Provisioning                                 â”‚
â”‚  1. PostgreSQL DB ìƒì„±                                       â”‚
â”‚  2. Redis DB ì¸ë±ìŠ¤ ì˜ˆì•½                                     â”‚
â”‚  3. MinIO ë²„í‚· ìƒì„±                                          â”‚
â”‚  4. Caddy ì„¤ì • ì—…ë°ì´íŠ¸ (ë„ë©”ì¸ â†’ í¬íŠ¸)                      â”‚
â”‚  5. Podman ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹œì‘                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Running Application                                         â”‚
â”‚  - ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰                                         â”‚
â”‚  - í—¬ìŠ¤ ì²´í¬                                                 â”‚
â”‚  - ëª¨ë‹ˆí„°ë§ í™œì„±í™”                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Registry ì‹œìŠ¤í…œ

ëª¨ë“  í”„ë¡œì íŠ¸ì˜ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ì¤‘ì•™ ì €ì¥ì†Œ

```json
// /opt/codeb/registry/projects.json
{
  "food-delivery-app": {
    "id": "food-delivery-app",
    "name": "ìŒì‹ ë°°ë‹¬ ì„œë¹„ìŠ¤",
    "status": "running",
    "created_at": "2025-01-09T10:00:00Z",
    "ports": {
      "app": 3005,
      "internal": 3006
    },
    "database": {
      "name": "food_delivery_db",
      "port": 5432
    },
    "redis": {
      "db_index": 2
    },
    "minio": {
      "bucket": "food-delivery-uploads"
    },
    "domain": "food-delivery.leocompany.com",
    "container_id": "abc123def456",
    "health": {
      "status": "healthy",
      "last_check": "2025-01-09T14:30:00Z"
    }
  }
}
```

### Terraform í†µí•© (ì„ íƒì )

ëŒ€ê·œëª¨ ì¸í”„ë¼ ê´€ë¦¬ ì‹œ Terraform ì‚¬ìš©

```hcl
# infrastructure/terraform/main.tf

# Vultr Provider
terraform {
  required_providers {
    vultr = {
      source  = "vultr/vultr"
      version = "~> 2.0"
    }
  }
}

provider "vultr" {
  api_key = var.vultr_api_key
}

# ì„œë²„ ì¸ìŠ¤í„´ìŠ¤
resource "vultr_instance" "app_server" {
  count    = var.app_server_count
  plan     = "vc2-4c-16gb"
  region   = "icn"  # Seoul
  os_id    = 387    # Ubuntu 22.04
  label    = "codeb-app-${count.index + 1}"
  hostname = "app${count.index + 1}.leocompany.com"

  ssh_key_ids = [vultr_ssh_key.deploy.id]
  firewall_group_id = vultr_firewall_group.web.id
}

# ë°©í™”ë²½ ê·œì¹™
resource "vultr_firewall_group" "web" {
  description = "CodeB Web Firewall"
}

resource "vultr_firewall_rule" "http" {
  firewall_group_id = vultr_firewall_group.web.id
  protocol          = "tcp"
  ip_type           = "v4"
  subnet            = "0.0.0.0"
  subnet_size       = 0
  port              = "80"
}

resource "vultr_firewall_rule" "https" {
  firewall_group_id = vultr_firewall_group.web.id
  protocol          = "tcp"
  ip_type           = "v4"
  subnet            = "0.0.0.0"
  subnet_size       = 0
  port              = "443"
}

# Load Balancer
resource "vultr_load_balancer" "main" {
  region = "icn"
  label  = "codeb-lb"

  forwarding_rules {
    frontend_protocol = "https"
    frontend_port     = 443
    backend_protocol  = "http"
    backend_port      = 80
  }

  health_check {
    protocol = "http"
    port     = 80
    path     = "/api/health"
    check_interval = 15
    response_timeout = 5
    unhealthy_threshold = 3
    healthy_threshold = 2
  }

  instances = vultr_instance.app_server[*].id
}
```

---

## Layer 4: Agent/DevOps Layer

AI ì—ì´ì „íŠ¸ ë° CI/CD ê³„ì¸µ - ê°œë°œ/ë°°í¬ ì›Œí¬í”Œë¡œìš°ë¥¼ ìë™í™”í•˜ëŠ” ë ˆì´ì–´

### Claude Code ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

#### ì—ì´ì „íŠ¸ êµ¬ì„±

```
Master Orchestrator (@orchestrator)
    â”œâ”€â”€ PM & Spec (@pm-spec)
    â”‚   â””â”€â”€ ì—­í• : PRD ì‘ì„±, ìš”êµ¬ì‚¬í•­ ë¶„ì„
    â”‚
    â”œâ”€â”€ Architect (@architect)
    â”‚   â””â”€â”€ ì—­í• : DB ìŠ¤í‚¤ë§ˆ, API ì„¤ê³„
    â”‚
    â”œâ”€â”€ Backend Developer (@backend-dev)
    â”‚   â””â”€â”€ ì—­í• : Next.js API, Prisma ì½”ë“œ
    â”‚
    â”œâ”€â”€ Frontend Developer (@frontend-dev)
    â”‚   â””â”€â”€ ì—­í• : React ì»´í¬ë„ŒíŠ¸, UI êµ¬í˜„
    â”‚
    â”œâ”€â”€ QA Gate (@qa-gate)
    â”‚   â””â”€â”€ ì—­í• : ì½”ë“œ ë¦¬ë·°, ë¦°íŠ¸, ë³´ì•ˆ ê²€ì‚¬
    â”‚
    â”œâ”€â”€ E2E Tester (@e2e-tester)
    â”‚   â””â”€â”€ ì—­í• : Playwright í…ŒìŠ¤íŠ¸ ì‘ì„±/ì‹¤í–‰
    â”‚
    â””â”€â”€ Infrastructure Ops (@infra-ops)
        â””â”€â”€ ì—­í• : ë°°í¬, ì¸í”„ë¼ ê´€ë¦¬
```

#### ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ: ìƒˆ ê¸°ëŠ¥ ê°œë°œ

```
1. ì‚¬ìš©ì ìš”ì²­
   "ìŒì‹ ë°°ë‹¬ ì•±ì— ì‹¤ì‹œê°„ ë°°ë‹¬ ì¶”ì  ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì¤˜"

2. @orchestrator ë¶„ì„
   - ë³µì¡ë„ í‰ê°€: ì¤‘ìƒ
   - í•„ìš” ì—ì´ì „íŠ¸: @architect, @backend-dev, @frontend-dev, @e2e-tester
   - ì‘ì—… ë¶„í•´ ë° í• ë‹¹

3. @architect ì„¤ê³„
   - DB ìŠ¤í‚¤ë§ˆ: delivery_tracking í…Œì´ë¸”
   - API ì„¤ê³„: WebSocket /api/tracking/:orderId
   - ì¸í”„ë¼: Redis Pub/Sub í™œìš©

4. @backend-dev êµ¬í˜„
   - Prisma ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸
   - WebSocket ì„œë²„ êµ¬í˜„
   - Redis Pub/Sub ë¡œì§

5. @frontend-dev êµ¬í˜„
   - ì‹¤ì‹œê°„ ì§€ë„ ì»´í¬ë„ŒíŠ¸
   - WebSocket í´ë¼ì´ì–¸íŠ¸
   - ìœ„ì¹˜ ì—…ë°ì´íŠ¸ UI

6. @qa-gate ê²€í† 
   - TypeScript íƒ€ì… ì²´í¬
   - ESLint ê²€ì‚¬
   - ë³´ì•ˆ ì·¨ì•½ì  ìŠ¤ìº”

7. @e2e-tester í…ŒìŠ¤íŠ¸
   - Playwright ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±
   - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ê²€ì¦
   - ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

8. @infra-ops ë°°í¬
   - ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ (WebSocket í¬íŠ¸ ì¶”ê°€)
   - Blue-Green ë°°í¬
   - í—¬ìŠ¤ ì²´í¬ í™•ì¸
```

### GitHub Actions CI/CD íŒŒì´í”„ë¼ì¸

#### Workflow íŒŒì¼ êµ¬ì¡°

```yaml
.github/workflows/
â”œâ”€â”€ build-test.yml          # ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸
â”œâ”€â”€ deploy-dev.yml          # ê°œë°œ í™˜ê²½ ë°°í¬
â”œâ”€â”€ deploy-prod.yml         # í”„ë¡œë•ì…˜ ë°°í¬ (ìŠ¹ì¸ í•„ìš”)
â”œâ”€â”€ ai-analysis.yml         # ë¹Œë“œ ì‹¤íŒ¨ ì‹œ AI ë¶„ì„
â””â”€â”€ backup.yml              # ìë™ ë°±ì—…
```

#### ë°°í¬ íŒŒì´í”„ë¼ì¸ ìƒì„¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Push (main ë¸Œëœì¹˜)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Build & Test                                          â”‚
â”‚  - npm ci (ì˜ì¡´ì„± ì„¤ì¹˜)                                        â”‚
â”‚  - npm run type-check (TypeScript)                             â”‚
â”‚  - npm run lint (ESLint)                                       â”‚
â”‚  - npm run test (Jest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸)                             â”‚
â”‚  - npm run build (Next.js ë¹Œë“œ)                                â”‚
â”‚  - npm run test:e2e (Playwright E2E)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: Container Image Build                                 â”‚
â”‚  - Docker ì´ë¯¸ì§€ ë¹Œë“œ                                          â”‚
â”‚  - GHCR (GitHub Container Registry)ì— í‘¸ì‹œ                     â”‚
â”‚  - íƒœê·¸: sha-abc123, main, latest                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: Approval Gate (í”„ë¡œë•ì…˜ë§Œ)                            â”‚
â”‚  - Leo ìŠ¹ì¸ ëŒ€ê¸°                                               â”‚
â”‚  - Slack ì•Œë¦¼                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ ìŠ¹ì¸ë¨
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: Deploy (Blue-Green)                                   â”‚
â”‚  1. SSH ì ‘ì† â†’ ì„œë²„                                            â”‚
â”‚  2. ìƒˆ ì»¨í…Œì´ë„ˆ ì‹œì‘ (Green)                                   â”‚
â”‚  3. í—¬ìŠ¤ ì²´í¬ (10ì´ˆ ëŒ€ê¸°)                                      â”‚
â”‚  4. Caddy ì„¤ì • ì—…ë°ì´íŠ¸ (íŠ¸ë˜í”½ ì „í™˜)                          â”‚
â”‚  5. ì´ì „ ì»¨í…Œì´ë„ˆ ì¤‘ì§€ (Blue) - 1ì‹œê°„ í›„                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 5: Post-Deploy                                           â”‚
â”‚  - í—¬ìŠ¤ ì²´í¬ 3íšŒ ì—°ì† ì„±ê³µ í™•ì¸                                â”‚
â”‚  - Slack ë°°í¬ ì™„ë£Œ ì•Œë¦¼                                        â”‚
â”‚  - Sentry ë¦´ë¦¬ìŠ¤ íƒœê·¸                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AI ê¸°ë°˜ ë¹Œë“œ ì‹¤íŒ¨ ë¶„ì„

ë¹Œë“œ ì‹¤íŒ¨ ì‹œ Claudeê°€ ìë™ìœ¼ë¡œ ì›ì¸ ë¶„ì„ ë° í•´ê²° ë°©ë²• ì œì‹œ

```yaml
# .github/workflows/ai-analysis.yml
name: AI Build Failure Analysis

on:
  workflow_run:
    workflows: ["Build and Deploy"]
    types: [completed]

jobs:
  analyze:
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    runs-on: ubuntu-latest

    steps:
      - name: Download Build Logs
        run: |
          gh run download ${{ github.event.workflow_run.id }} \
            --name build-logs

      - name: Analyze with Claude
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        run: |
          ERROR_LOG=$(cat build.log | grep -A 20 "error")

          # Claude API í˜¸ì¶œ
          ANALYSIS=$(curl https://api.anthropic.com/v1/messages \
            -H "x-api-key: $ANTHROPIC_API_KEY" \
            -d '{
              "model": "claude-sonnet-4-20250514",
              "messages": [{
                "role": "user",
                "content": "ë¹Œë“œ ì—ëŸ¬ ë¶„ì„:\n\n'"$ERROR_LOG"'"
              }]
            }' | jq -r '.content[0].text')

          # GitHub Issue ìƒì„±
          gh issue create \
            --title "ğŸ”´ ë¹Œë“œ ì‹¤íŒ¨: $(git rev-parse --short HEAD)" \
            --body "## AI ë¶„ì„ ê²°ê³¼\n\n$ANALYSIS" \
            --label "build-failure,ai-analyzed"
```

---

## ë°ì´í„° íë¦„

### ì‚¬ìš©ì ìš”ì²­ â†’ ì‘ë‹µ ì „ì²´ íë¦„

```
1. ì‚¬ìš©ì ë¸Œë¼ìš°ì €
   https://food-delivery.leocompany.com/api/restaurants
   â”‚
   â–¼
2. DNS ì¡°íšŒ
   food-delivery.leocompany.com â†’ 45.76.178.123
   â”‚
   â–¼
3. Caddy (Reverse Proxy)
   :443 â†’ :3005 (ë‚´ë¶€ í¬íŠ¸ë¡œ í”„ë¡ì‹œ)
   + SSL í„°ë¯¸ë„¤ì´ì…˜
   + gzip ì••ì¶•
   â”‚
   â–¼
4. Next.js App (:3005)
   /api/restaurants í•¸ë“¤ëŸ¬ ì‹¤í–‰
   â”‚
   â”œâ”€â–¶ 5a. PostgreSQL ì¿¼ë¦¬
   â”‚   SELECT * FROM restaurants WHERE active = true
   â”‚   + Connection Pooling (Prisma)
   â”‚
   â”œâ”€â–¶ 5b. Redis ìºì‹œ ì²´í¬
   â”‚   GET restaurants:list:active
   â”‚   + TTL: 5ë¶„
   â”‚
   â””â”€â–¶ 5c. MinIO ì´ë¯¸ì§€ URL ìƒì„±
       restaurant.image_url â†’ signed URL (1ì‹œê°„ ìœ íš¨)
   â”‚
   â–¼
6. JSON ì‘ë‹µ ìƒì„±
   {
     "restaurants": [...],
     "total": 150,
     "cached": true
   }
   â”‚
   â–¼
7. Caddy â†’ ì‚¬ìš©ì
   + gzip ì••ì¶• ì‘ë‹µ
   + HSTS í—¤ë” ì¶”ê°€
   â”‚
   â–¼
8. ì‚¬ìš©ì ë¸Œë¼ìš°ì €
   ë Œë”ë§
```

---

## ë°°í¬ í”„ë¡œì„¸ìŠ¤

### Blue-Green ë¬´ì¤‘ë‹¨ ë°°í¬

```
Initial State: Blue ì‹¤í–‰ ì¤‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Caddy                                                   â”‚
â”‚    â†“                                                     â”‚
â”‚  Blue Container (v1.0)  :3005  [RUNNING]                 â”‚
â”‚  Green Container        :3006  [STOPPED]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Green ì»¨í…Œì´ë„ˆ ì‹œì‘ (v1.1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Caddy                                                   â”‚
â”‚    â†“                                                     â”‚
â”‚  Blue Container (v1.0)  :3005  [RUNNING]  â† í˜„ì¬ íŠ¸ë˜í”½  â”‚
â”‚  Green Container (v1.1) :3006  [STARTING]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: í—¬ìŠ¤ ì²´í¬ (10ì´ˆ ëŒ€ê¸°)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Health Check: GET localhost:3006/api/health             â”‚
â”‚  âœ… Status 200 OK                                        â”‚
â”‚  âœ… Response time < 500ms                                â”‚
â”‚  âœ… Database connection OK                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: Caddy ì„¤ì • ì—…ë°ì´íŠ¸ (íŠ¸ë˜í”½ ì „í™˜)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Caddy (ì„¤ì • ë¦¬ë¡œë“œ: caddy reload)                       â”‚
â”‚    â†“                                                     â”‚
â”‚  Blue Container (v1.0)  :3005  [RUNNING]                 â”‚
â”‚  Green Container (v1.1) :3006  [RUNNING]  â† ìƒˆ íŠ¸ë˜í”½   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 4: Blue ì»¨í…Œì´ë„ˆ ì¤‘ì§€ (1ì‹œê°„ í›„, ë¡¤ë°± ëŒ€ë¹„)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Caddy                                                   â”‚
â”‚    â†“                                                     â”‚
â”‚  Blue Container (v1.0)  :3005  [STOPPED]                 â”‚
â”‚  Green Container (v1.1) :3006  [RUNNING]  â† ëª¨ë“  íŠ¸ë˜í”½  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë§Œì•½ í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨ â†’ ìë™ ë¡¤ë°±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ Health Check Failed                                  â”‚
â”‚  â†’ Green ì»¨í…Œì´ë„ˆ ì¤‘ì§€                                   â”‚
â”‚  â†’ Blue ì»¨í…Œì´ë„ˆ ìœ ì§€ (ë¡¤ë°± ì™„ë£Œ)                        â”‚
â”‚  â†’ Slack ì•Œë¦¼: "ë°°í¬ ì‹¤íŒ¨ - ìë™ ë¡¤ë°±ë¨"                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë³´ì•ˆ ì•„í‚¤í…ì²˜

### ë‹¤ì¸µ ë³´ì•ˆ (Defense in Depth)

```
Layer 1: Network Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  - Vultr ë°©í™”ë²½ (í¬íŠ¸ 22, 80, 443ë§Œ í—ˆìš©)          â”‚
â”‚  - SSH í‚¤ ê¸°ë°˜ ì¸ì¦ (ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ ë¹„í™œì„±í™”)     â”‚
â”‚  - Fail2Ban (ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ì°¨ë‹¨)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 2: Application Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  - NextAuth.js ì¸ì¦ (JWT + Session)                â”‚
â”‚  - CSRF í† í° ê²€ì¦                                  â”‚
â”‚  - XSS ë°©ì§€ (Content Security Policy)             â”‚
â”‚  - SQL Injection ë°©ì§€ (Prisma Parameterized Query) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 3: Data Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  - PostgreSQL: ì•”í˜¸í™”ëœ ì—°ê²° (SSL/TLS)             â”‚
â”‚  - Redis: requirepass ì„¤ì •                         â”‚
â”‚  - MinIO: ë²„í‚· ì ‘ê·¼ ì œì–´ (ACL)                     â”‚
â”‚  - Vault: ì‹œí¬ë¦¿ ê´€ë¦¬ (í™˜ê²½ ë³€ìˆ˜ ì•”í˜¸í™”)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 4: Transport Security
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  - Caddy ìë™ SSL (Let's Encrypt)                  â”‚
â”‚  - TLS 1.3 ê°•ì œ                                    â”‚
â”‚  - HSTS í—¤ë” (1ë…„)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‹œí¬ë¦¿ ê´€ë¦¬ (Vault í†µí•©)

```bash
# Vaultì— ì‹œí¬ë¦¿ ì €ì¥
vault kv put secret/projects/food-delivery \
  DATABASE_URL="postgresql://..." \
  NEXTAUTH_SECRET="..." \
  SMTP_PASSWORD="..."

# ë°°í¬ ì‹œ ìë™ ì£¼ì…
# GitHub Actionsì—ì„œ:
- name: Inject Secrets
  run: |
    export DATABASE_URL=$(vault kv get -field=DATABASE_URL secret/projects/food-delivery)
    ssh deploy@server "echo DATABASE_URL=$DATABASE_URL >> /opt/apps/food-delivery/.env"
```

---

## ëª¨ë‹ˆí„°ë§ ë° ê´€ì°°ì„±

### 3-Pillar Observability

```
1. Metrics (ë©”íŠ¸ë¦­)
   Prometheus + Grafana
   - CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ 
   - ìš”ì²­ ìˆ˜ (RPS)
   - ì‘ë‹µ ì‹œê°„ (p50, p95, p99)
   - ì—ëŸ¬ìœ¨

2. Logs (ë¡œê·¸)
   systemd journald + Loki
   - ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸
   - ì—ëŸ¬ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤
   - ì ‘ê·¼ ë¡œê·¸
   - ê°ì‚¬ ë¡œê·¸

3. Traces (íŠ¸ë ˆì´ì‹±)
   OpenTelemetry (í–¥í›„ ì¶”ê°€)
   - ë¶„ì‚° íŠ¸ë ˆì´ì‹±
   - ì„œë¹„ìŠ¤ ê°„ í˜¸ì¶œ ì¶”ì 
```

### Grafana ëŒ€ì‹œë³´ë“œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CodeB Production Dashboard                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  ì´ ìš”ì²­ìˆ˜  â”‚  â”‚  í‰ê·  ì‘ë‹µ  â”‚  â”‚   ì—ëŸ¬ìœ¨   â”‚             â”‚
â”‚  â”‚   15.2K    â”‚  â”‚   120ms    â”‚  â”‚   0.02%    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚  [ì‘ë‹µ ì‹œê°„ ê·¸ë˜í”„]                                          â”‚
â”‚  300ms â”¤                                                     â”‚
â”‚  200ms â”¤     â•­â”€â•®         â•­â”€â•®                                â”‚
â”‚  100ms â”¤â”€â”€â”€â”€â”€â•¯ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•°â”€â”€â”€â”€â”€                           â”‚
â”‚      0 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                        â”‚
â”‚        12:00  13:00  14:00  15:00                            â”‚
â”‚                                                              â”‚
â”‚  [í”„ë¡œì íŠ¸ë³„ ìƒíƒœ]                                           â”‚
â”‚  âœ… food-delivery-app    :3005  [HEALTHY]  2 req/s          â”‚
â”‚  âœ… real-estate-cms      :3010  [HEALTHY]  5 req/s          â”‚
â”‚  âš ï¸  blog-platform       :3015  [DEGRADED] 1 req/s          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í™•ì¥ ì „ëµ

### ìˆ˜í‰ í™•ì¥ (Horizontal Scaling)

```
í˜„ì¬: ë‹¨ì¼ ì„œë²„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Server 1 (45.76.178.123)          â”‚
â”‚  - App:3005                        â”‚
â”‚  - PostgreSQL:5432                 â”‚
â”‚  - Redis:6379                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í™•ì¥: ë¡œë“œ ë°¸ëŸ°ì„œ + ë‹¤ì¤‘ ì„œë²„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Balancer (Vultr LB)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚          â”‚          â”‚          â”‚
         â–¼          â–¼          â–¼          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ App #1 â”‚ â”‚ App #2 â”‚ â”‚ App #3 â”‚ â”‚ App #N â”‚
    â”‚ :3005  â”‚ â”‚ :3005  â”‚ â”‚ :3005  â”‚ â”‚ :3005  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚          â”‚          â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ê³µìœ  DB/Redis/MinIO      â”‚
         â”‚  (ë³„ë„ ì„œë²„ë¡œ ë¶„ë¦¬)       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì „ëµ

```yaml
# Vultr API + Cron ê¸°ë°˜ ì˜¤í† ìŠ¤ì¼€ì¼ë§
# /opt/scripts/auto-scale.sh

#!/bin/bash
# CPU ì‚¬ìš©ë¥  ì²´í¬
CPU=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)

if (( $(echo "$CPU > 70" | bc -l) )); then
  echo "CPU $CPU% - ì„œë²„ ì¦ì„¤"

  # Vultr APIë¡œ ìƒˆ ì„œë²„ ìƒì„±
  curl -X POST "https://api.vultr.com/v2/instances" \
    -H "Authorization: Bearer $VULTR_API_KEY" \
    -d '{
      "region": "icn",
      "plan": "vc2-4c-16gb",
      "label": "codeb-app-auto-$(date +%s)",
      "os_id": 387
    }'

  # LBì— ì„œë²„ ì¶”ê°€ (ìë™)
fi

if (( $(echo "$CPU < 30" | bc -l) )); then
  # ì„œë²„ ì¶•ì†Œ (ìµœì†Œ 2ëŒ€ ìœ ì§€)
  echo "CPU $CPU% - ìœ íœ´ ì„œë²„ ì œê±°"
fi
```

---

## ì°¸ê³  ë¬¸ì„œ

- `project-manifest.schema.yaml`: í”„ë¡œì íŠ¸ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ìŠ¤í‚¤ë§ˆ ì •ì˜
- `example-project.yaml`: ì‹¤ì œ í”„ë¡œì íŠ¸ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì˜ˆì œ
- `/docs/deployment-guide.md`: ë°°í¬ ê°€ì´ë“œ
- `/docs/monitoring-setup.md`: ëª¨ë‹ˆí„°ë§ ì„¤ì • ê°€ì´ë“œ
- `plan.md`: ì „ì²´ ì‹œìŠ¤í…œ ì„¤ê³„ ë¬¸ì„œ

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-09
**ë¬¸ì„œ ë²„ì „**: 1.0
**ê´€ë¦¬ì**: Leo Company DevOps Team
